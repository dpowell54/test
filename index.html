<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="theme-color" content="#101827" />
  <meta name="description" content="Decision Firewall - a personal decision journal and dopamine friction tool." />
  <link rel="manifest" href="manifest.webmanifest" />
  <link rel="apple-touch-icon" href="icons/apple-touch-icon.svg" />
  <link rel="icon" href="icons/icon-192.svg" type="image/svg+xml" />
  <link rel="stylesheet" href="styles.css" />
  <title>Decision Firewall</title>
</head>
<body>
  <header class="app-header">
    <div>
      <h1>Decision Firewall</h1>
      <p class="subtitle">Pause. Log. Learn. Protect Future You.</p>
    </div>
    <div class="status" id="offlineStatus">Offline ready: <span>Checking…</span></div>
  </header>

  <nav class="quick-actions">
    <button class="primary" data-route="home">Home</button>
    <button data-route="quick-log">Quick Log</button>
    <button data-route="pause">10-second Pause</button>
    <button data-route="checkin">Daily Check-in</button>
    <button data-route="insights">Insights</button>
    <button data-route="history">History</button>
    <button data-route="settings">Settings</button>
  </nav>

  <main>
    <section id="screen-home" class="screen active">
      <div class="card">
        <div class="row-between">
          <div>
            <h2>Today</h2>
            <p id="todaySummary">Loading…</p>
          </div>
          <div class="time-box">
            <div id="currentTime">--:--</div>
            <div id="riskStatus">Checking risk…</div>
          </div>
        </div>
        <div id="riskWarning" class="warning hidden">
          <h3>High-risk window</h3>
          <p id="riskWindowText">Stay intentional. Take the 10-second pause.</p>
          <button class="primary" data-route="pause">Do the 10-second pause</button>
        </div>
      </div>

      <div class="card">
        <h2>Quick actions</h2>
        <div class="grid-2">
          <button class="primary" data-route="quick-log">Quick Log</button>
          <button data-route="pause">10-second Pause</button>
          <button data-route="checkin">Daily Check-in</button>
          <button data-route="insights">Insights</button>
          <button data-route="history">History</button>
          <button data-route="settings">Settings</button>
        </div>
      </div>

      <div class="card">
        <h2>Privacy</h2>
        <p>Everything stays on this device. No accounts, no tracking, no network calls.</p>
      </div>
    </section>

    <section id="screen-quick-log" class="screen">
      <div class="card">
        <h2>Quick Log</h2>
        <form id="decisionForm" class="stack">
          <label>
            Decision type
            <select id="decisionType" required>
              <option value="Phone/Scroll">Phone/Scroll</option>
              <option value="Workout">Workout</option>
              <option value="Food">Food</option>
              <option value="Spending">Spending</option>
              <option value="Sleep">Sleep</option>
              <option value="Work">Work</option>
              <option value="Relationship">Relationship</option>
              <option value="Other">Other</option>
            </select>
          </label>
          <label>
            Custom type (optional)
            <input type="text" id="decisionTypeCustom" placeholder="e.g. Learning" />
          </label>

          <div>
            <div class="label">Outcome</div>
            <div class="pill-group" id="outcomeGroup">
              <button type="button" data-value="Good">Good for future me</button>
              <button type="button" data-value="Neutral">Neutral</button>
              <button type="button" data-value="Regret">Regret</button>
            </div>
          </div>

          <div>
            <div class="label">Mood</div>
            <div class="pill-group" id="moodGroup"></div>
          </div>

          <div>
            <div class="label">Energy</div>
            <div class="pill-group" id="energyGroup"></div>
          </div>

          <label>
            One-line note (optional)
            <input type="text" id="decisionNote" maxlength="140" />
          </label>

          <label>
            Tags (comma-separated)
            <input type="text" id="decisionTags" placeholder="e.g. late-night, doomscroll" />
          </label>

          <button type="submit" class="primary" id="saveDecision">Save entry</button>
          <div id="decisionFeedback" class="feedback">Saved ✔</div>
        </form>
      </div>
    </section>

    <section id="screen-pause" class="screen">
      <div class="card pause-card">
        <h2>10-second Pause</h2>
        <p class="pause-question">Is this a choice Future Me thanks me for?</p>
        <div class="timer" id="pauseTimer">10</div>
        <button id="pauseConfirm" class="primary" disabled>I'm sure</button>
        <button class="ghost" data-route="home">Back to Home</button>
      </div>
    </section>

    <section id="screen-checkin" class="screen">
      <div class="card">
        <h2>Daily Check-in</h2>
        <div id="checkinStatus" class="status-pill">Checking…</div>
        <form id="checkinForm" class="stack">
          <div>
            <div class="label">Mood</div>
            <div class="pill-group" id="checkinMoodGroup"></div>
          </div>
          <div>
            <div class="label">Energy</div>
            <div class="pill-group" id="checkinEnergyGroup"></div>
          </div>
          <div>
            <div class="label">Sleep quality</div>
            <div class="pill-group" id="checkinSleepGroup"></div>
          </div>
          <label>
            Optional note
            <input type="text" id="checkinNote" maxlength="140" />
          </label>
          <button type="submit" class="primary">Save check-in</button>
        </form>
      </div>
    </section>

    <section id="screen-insights" class="screen">
      <div class="card">
        <div class="row-between">
          <h2>Insights</h2>
          <div class="toggle">
            <button id="insights7" class="active">7 days</button>
            <button id="insights30">30 days</button>
          </div>
        </div>
        <div id="insightsContent" class="stack">Loading insights…</div>
      </div>
    </section>

    <section id="screen-history" class="screen">
      <div class="card">
        <h2>History</h2>
        <div class="filters">
          <select id="filterType">
            <option value="">All types</option>
            <option value="Phone/Scroll">Phone/Scroll</option>
            <option value="Workout">Workout</option>
            <option value="Food">Food</option>
            <option value="Spending">Spending</option>
            <option value="Sleep">Sleep</option>
            <option value="Work">Work</option>
            <option value="Relationship">Relationship</option>
            <option value="Other">Other</option>
          </select>
          <select id="filterOutcome">
            <option value="">All outcomes</option>
            <option value="Good">Good for future me</option>
            <option value="Neutral">Neutral</option>
            <option value="Regret">Regret</option>
          </select>
        </div>
        <div id="historyList" class="history-list">Loading…</div>
      </div>
    </section>

    <section id="screen-settings" class="screen">
      <div class="card">
        <h2>Settings</h2>
        <form id="settingsForm" class="stack">
          <label>
            Risk threshold: minimum samples per hour
            <input type="number" id="minSamples" min="1" max="20" />
          </label>
          <label>
            Risk threshold: regret % (60 means 60%)
            <input type="number" id="regretThreshold" min="10" max="100" />
          </label>
          <label>
            Target bedtime (optional)
            <input type="time" id="bedtime" />
          </label>
          <button type="submit" class="primary">Save settings</button>
        </form>
      </div>

      <div class="card">
        <h2>Data</h2>
        <div class="stack">
          <button id="exportJson" class="primary">Export data (JSON)</button>
          <button id="exportCsv">Export decisions (CSV)</button>
          <label class="file-input">
            Import data (JSON)
            <input type="file" id="importJson" accept="application/json" />
          </label>
          <button id="clearAll" class="danger">Clear all data</button>
        </div>
      </div>

      <div class="card">
        <h2>Storage</h2>
        <p id="storageStatus">Checking…</p>
      </div>
    </section>
  </main>

  <div id="editModal" class="modal hidden">
    <div class="modal-content">
      <h3>Edit entry</h3>
      <form id="editForm" class="stack">
        <label>
          Decision type
          <input type="text" id="editType" />
        </label>
        <label>
          Outcome
          <select id="editOutcome">
            <option value="Good">Good for future me</option>
            <option value="Neutral">Neutral</option>
            <option value="Regret">Regret</option>
          </select>
        </label>
        <label>
          Mood (1-5)
          <input type="number" id="editMood" min="1" max="5" />
        </label>
        <label>
          Energy (1-5)
          <input type="number" id="editEnergy" min="1" max="5" />
        </label>
        <label>
          Note
          <input type="text" id="editNote" />
        </label>
        <div class="row-between">
          <button type="submit" class="primary">Save changes</button>
          <button type="button" id="deleteEntry" class="danger">Delete</button>
          <button type="button" id="closeModal" class="ghost">Close</button>
        </div>
      </form>
    </div>
  </div>

  <script src="db.js"></script>
  <script src="insights.js"></script>
  <script src="app.js"></script>
</body>
</html>
